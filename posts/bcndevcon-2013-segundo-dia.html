
<!DOCTYPE html>
<html lang="es-es">

    <head>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta property="og:title" content=" Segundo día en la BcnDevCon&#39;13 &middot;  Entre Dev y Ops" />
        <meta property="og:site_name" content="Entre Dev y Ops" />
        <meta property="og:url" content="http://www.entredevyops.es/posts/bcndevcon-2013-segundo-dia.html" />

    
        <meta property="og:type" content="article" />
        <meta property="og:article:published_time" content="2013-11-11T07:00:00Z" />
        <meta property="og:article:tag" content="Eventos" />
        <meta property="og:article:tag" content="BcnDevCon" />
        <meta property="og:article:tag" content="DevOps" />
        <meta property="og:article:tag" content="Escalabilidad" />
        <meta property="og:article:tag" content="Python" />
        <meta property="og:article:tag" content="Pruebas" />
        <meta property="og:article:tag" content="TDD" />
        

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@entredevyops" />
        <meta name="twitter:creator" content="@entredevyops" />
        <meta name="twitter:title" content="Segundo día en la BcnDevCon&#39;13" />
        
        <meta name="twitter:description" content="



El segundo día de la BcnDevCon&#39;13 estuvo plagado de charlas y actividades, el final del Hackathon for education, Los concursos de Mario Kart y Street Fighter. El salón de RetroBarcelona fue muy visitado y la Agile Station, coordinada por la gente de Agile BCN, tuvo una actividad frenética, como el día anterior.
" />
        <meta name="twitter:url" content="http://www.entredevyops.es/posts/bcndevcon-2013-segundo-dia.html" />
    

        <title> Segundo día en la BcnDevCon&#39;13 &middot;  Entre Dev y Ops</title>

        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
        <link rel="preload" href="/js/main.js" as="script" />
        <link rel="preload" href="/css/main.css" as="style" />
        
        
            <link rel="shortcut icon" href="/images/edyo-icon.png" />
        


    
        <meta name="description" content="El podcast en el que hablamos sobre desarrollo de aplicaciones, operaciones de sistemas informáticos y todo lo relacionado con la filosofía DevOps" />
    

    
        <meta name="p:domain_verify" content=""/>
    

        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
        

    
        <link href="http://www.entredevyops.es/index.xml" rel="alternate" type="application/rss+xml" title="Entre Dev y Ops" />
    

    
        <link rel="canonical" href="http://www.entredevyops.es/posts/bcndevcon-2013-segundo-dia.html" />


    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "http://www.entredevyops.es/posts/bcndevcon-2013-segundo-dia.html"
        },
        "headline": "Segundo día en la BcnDevCon&#39;13",
        "description": "",
        "author": {
            "@type": "Person",
            "name": " ",
            "url": "http://profiles.google.com/?rel=author",
            "image": {
              "@type": "ImageObject",
              "url": "https:",
              "height": 80,
              "width": 80
            }
        },
        "publisher": {
          "@type": "Organization",
          "@id": "http://www.entredevyops.es/",
          "name": "Entre Dev y Ops",
          "url": "http://www.entredevyops.es/",
          "logo": {
            "@type": "ImageObject",
            "url": "https:",
            "height": 80,
            "width": 80
          }
        },
        
        "image": {
          "@type": "ImageObject",
          "url": "",
          "height": 80,
          "width": 80
        },
        "datePublished": "2013-11-11",
        "dateModified": "2013-11-11",
        "wordCount": 1954,
        "keywords": ["Eventos","BcnDevCon","DevOps","Escalabilidad","Python","Pruebas","TDD"] 
    }
    </script>


    
    <script type="text/javascript">
    
    
      var disqus_shortname = 'edyo';
      var disqus_identifier = 'http:\/\/www.entredevyops.es\/posts\/bcndevcon-2013-segundo-dia.html';
      var disqus_title = 'Segundo día en la BcnDevCon\x2713';
      var disqus_url = 'http:\/\/www.entredevyops.es\/posts\/bcndevcon-2013-segundo-dia.html';
    
    </script>
    

    <script type="text/javascript">
      var config = {
        baseUrl: "http:\/\/www.entredevyops.es\/"
      };
    </script>

    <style>
html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,figure,footer,header,main,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:300;src:local("Merriweather Sans Light"),local(MerriweatherSans-Light),url(//fonts.gstatic.com/s/merriweathersans/v5/6LmGj5dOJopQKEkt88GowY_zIojJi0m4a5Z6tRh6itY.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:400;src:local("Merriweather Sans Regular"),local(MerriweatherSans-Regular),url(//fonts.gstatic.com/s/merriweathersans/v5/AKu1CjQ4qnV8MUltkAX3sL2aU247V0zTzydO4RoO9Ok.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:700;src:local("Merriweather Sans Bold"),local(MerriweatherSans-Bold),url(//fonts.gstatic.com/s/merriweathersans/v5/6LmGj5dOJopQKEkt88GowQfd-b-I5PxxcmB4_-MNcqw.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:normal;font-weight:800;src:local("Merriweather Sans ExtraBold"),local(MerriweatherSans-ExtraBold),url(//fonts.gstatic.com/s/merriweathersans/v5/6LmGj5dOJopQKEkt88GowWT7sFQ1Iz1BbpcuCPlgc9Q.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:italic;font-weight:300;src:local("Merriweather Sans Light Italic"),local(MerriweatherSans-LightItalic),url(//fonts.gstatic.com/s/merriweathersans/v5/nAqt4hiqwq3tzCecpgPmVX9UU5BmOJGkLxUCVv5VXdc.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:italic;font-weight:400;src:local("Merriweather Sans Italic"),local(MerriweatherSans-Italic),url(//fonts.gstatic.com/s/merriweathersans/v5/3Mz4hOHzs2npRMG3B1ascf0KIgDhPIHb_R-SWdtqte8.woff) format("woff")}@font-face{font-family:'Merriweather Sans';font-style:italic;font-weight:700;src:local("Merriweather Sans Bold Italic"),local(MerriweatherSans-BoldItalic),url(//fonts.gstatic.com/s/merriweathersans/v5/nAqt4hiqwq3tzCecpgPmVYM8pfYvjMoOxygpzLVILAs.woff) format("woff")}@font-face {font-family: 'Aldrich';font-style: normal;font-weight: 400;src: local('Aldrich Regular'), local('Aldrich-Regular'), url('//fonts.gstatic.com/s/aldrich/v8/j-NnyokbAnhXANS2iZ6Jew.woff2') format('woff2');unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215;font-style:normal}[class^="icon-"]:before{font-family:"icons";font-style:normal;font-weight:400;speak:none;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-arrow-right:before{content:'\e807'}.icon-rss:before{content:'\e808'}body{font:300 1em / 1.5em 'Merriweather Sans',sans-serif;color:#595B66}a{color:inherit;text-decoration:none;font-weight:400}h1,h2{text-rendering:optimizeLegibility;color:#1F2026}h2 a{font-weight:inherit}h1{font-size:2em;line-height:1em;margin:2em 0 -.5em}h2{font-size:1.75em;line-height:1.143em;margin:2.286em 0 -.571em}p{margin:2em auto}i{font-weight:400;font-style:italic;color:#363740}img{display:block;max-width:100%;height:auto;margin:2.5em auto}body{background:#fff}.inner{max-width:48em;margin:0 auto;padding:0 1em}#wrapper{position:relative;box-sizing:border-box;width:100%;min-height:100vh;padding-bottom:6em;background:#F2F3F5}#push{transform:translate3d(0,0,0);transform-style:preserve-3d;opacity:1}#nav{position:relative;background:#fff;z-index:70;transform:translate3d(0,0,0);transform-style:preserve-3d;opacity:1}#nav:after{clear:both;content:'';display:table}#nav .nav-logo{float:left;height:2em;padding:1em;max-width:50%}#nav .nav-logo img{width:auto;max-width:none;height:2em;margin:0;border-radius:5px}#nav .nav-menu{float:right}#nav .nav-menu:after{clear:both;content:'';display:table}#nav .nav-menu a{display:block;width:1em;height:1em;line-height:1em;padding:1.5em;text-align:center;float:left}#nav .nav-menu a i:before{margin:auto}.overlay{display:none;position:fixed;left:0;top:0;width:100%;height:100%;z-index:80;display:none}.overlay:before{content:'';position:absolute;left:0;top:0;width:100%;height:100%;background:#1F2026;opacity:0;transform-style:preserve-3d}#header{position:relative;padding:4em 0}#header .inner{position:relative;z-index:2}#header .header-title{display:block;text-align:center}#header .header-name{font-family: Aldrich, sans-serif;font-weight:700;letter-spacing:-1px;display:block;line-height:1em;font-size:2em;text-decoration:none;color:#1F2026;padding:0;margin:0}#header.has-cover .header-name{color:#fff}#header .header-description{display:block;margin:1em auto 0;color:#9D9FA6;position:relative;font-weight:300}#header .header-description:after{content:'';position:absolute;height:1px;width:100px;margin-left:-50px;left:50%;top:-.5em;background:#D4D5D9}#header.has-cover .header-description{color:#fff}#header.has-cover .header-description:after{background:#fff}#header .header-cover{position:absolute;width:100%;height:100%;top:0;left:0;margin-top:-4em;padding:4em 0;background:no-repeat fixed center 100% / cover;z-index:1}#header .header-cover:before{content:'';position:absolute;width:100%;height:100%;left:0;top:0;background:rgba(0,0,0,0.2)}#header .header-cover:after{content:'';position:absolute;width:100%;left:0;bottom:0;border-bottom:4px solid #19A0D7}#footer{position:absolute;width:100%;left:0;bottom:0;font-size:.75em;line-height:1.334em;background:#1F2026;color:#737580;z-index:20;transform:translate3d(0,0,0);transform-style:preserve-3d;opacity:1}#footer a{color:#9D9FA6;font-weight:400}#footer .credits{text-align:center;font-size:.75em;line-height:1.334em;padding:2.667em;overflow:auto}#footer .credits span{display:block}#footer .credits .credits-theme{float:left}#footer .credits .credits-software{float:right}.post{position:relative;z-index:20}.post .post-image{display:block;margin:0;padding:0}.post .post-image img{display:block;width:100%;height:auto;margin:0;padding:0}.post .post-meta{display:block;font-size:.75em;line-height:1.334em;font-weight:400;margin-bottom:1.334em}.post .post-title{position:relative;color:#000;font-size:2em;line-height:1.375em;font-weight:800;text-indent:-1px;margin:.25em 0 .75em}.post .post-title:before{content:'';position:absolute;left:0;bottom:-.334em;width:1em;margin-bottom:-2px;border-bottom:4px solid #19A0D7}.post .post-title a{text-decoration:none;color:inherit;font-weight:inherit}#post-index{position:relative;max-width:1200px;margin:0 auto 4em;padding:.5em;z-index:10}@keyframes fade{0%{transform:translate3d(0,3em,0);opacity:0}100%{transform:translate3d(0,0,0);opacity:1}}.post-list{position:relative}.post-list .post{float:left;width:33.3%;transform:translate3d(0,3em,0);transform-style:preserve-3d;opacity:0;animation:fade ease-out .5s forwards;animation-delay:1.4s}@media only screen and (max-width: 50em){.post-list .post{width:49.9%}}@media only screen and (max-width: 30em){.post-list .post{width:100%;float:none}}.post-list .post:nth-child(1){animation-delay:.1s}.post-list .post:nth-child(2){animation-delay:.2s}.post-list .post:nth-child(3){animation-delay:.3s}.post-list .post:nth-child(4){animation-delay:.4s}.post-list .post:nth-child(5){animation-delay:.5s}.post-list .post:nth-child(6){animation-delay:.6s}.post-list .post:nth-child(7){animation-delay:.7s}.post-list .post:nth-child(8){animation-delay:.8s}.post-list .post:nth-child(9){animation-delay:.9s}.post-list .post .inner{padding:2em;margin:.5em;max-width:none;background:#fff;box-sizing:border-box;transform:scale(1);transform-style:preserve-3d}@media only screen and (max-width: 50em){.post-list .post .inner{padding:1em}}.post-list .post .post-link{position:absolute;left:0;top:0;width:100%;height:100%;z-index:10}.post-list .post .post-image{position:relative;margin:-2em -2em 0;overflow:hidden;background:#19A0D7}@media only screen and (max-width: 50em){.post-list .post .post-image{margin:-1em -1em 0}}.post-list .post .post-image img{transform:scale(1);transform-style:preserve-3d;opacity:1}.post-list .post .post-image:after{content:'';position:absolute;left:-5%;bottom:-2.5em;width:110%;height:4em;background:#fff;border-top:4px solid #19A0D7;box-shadow:0 0 2em rgba(0,0,0,0.2);transform:rotate(5deg)}.post-list .post .post-title{font-size:1.5em;line-height:1.167em}.post-list .post .post-excerpt{margin:0}.post-list .post .post-more{display:block;margin-top:1.5em}.post-list .post .post-more a{display:inline-block;font-size:.875em;line-height:1.143em;font-weight:400;color:#363740}.post-list .post .post-more a i{color:#0e77a0}.pagination{min-height:3em;margin:4em auto 2em;padding:0;position:relative}.pagination .pagination-item{position:relative;display:block;height:3em;line-height:3em;padding:0 1em;text-align:center;text-decoration:none;font-weight:700;color:#363740;border:1px solid #19A0D7;border-radius:4em;z-index:60}.pagination .pagination-item i{position:relative}@media only screen and (max-width: 30em){.pagination .pagination-item{width:4em;height:4em;line-height:4em;margin-top:-.5em;padding:0!important}.pagination .pagination-item i{font-size:1.5em}.pagination .pagination-item>span{display:none}}.pagination .pagination-prev{float:right}.pagination .pagination-prev i{right:-.05em}.pagination .pagination-info{display:block;left:0;top:0;height:3em;line-height:3em;position:absolute;text-align:center;width:100%;z-index:50;color:#9D9FA6}#loader-wrapper{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000}#loader{display:block;position:relative;left:50%;top:50%;width:150px;height:150px;margin:-75px 0 0 -75px;border-radius:50%;border:3px solid transparent;border-top-color:#19A0D7;animation:spin 2s linear infinite}#loader:before{content:"";position:absolute;top:5px;left:5px;right:5px;bottom:5px;border-radius:50%;border:3px solid transparent;border-top-color:#0e77a0;animation:spin 3s linear infinite}#loader:after{content:"";position:absolute;top:15px;left:15px;right:15px;bottom:15px;border-radius:50%;border:3px solid transparent;border-top-color:#D4D5D9;animation:spin 1.5s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
</style>


    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
    <script>
    window.addEventListener("load", function(){
    window.cookieconsent.initialise({
    "palette": {
        "popup": {
        "background": "#222222"
        },
        "button": {
        "background": "#19a0d7"
        }
    },
    "content": {
        "message": "Esta web utiliza cookies de terceros para mejorar la experiencia de la web y recopilar datos de uso. Si continúas navegando, consideramos que aceptas su uso.",
        "dismiss": "Entendido",
        "link": "Política de cookies",
        "href": "politica-cookies.html"
    }
    })});
    </script>

    </head>
    <body class="home-template">
      <div id="loader-wrapper">
        <div id="loader"></div>
      </div>
      <section id="wrapper" style="display: none;">
        <div id="ajax-container">
          <nav id="nav" class="nav">
            <div class="nav-logo">
               <a href="http://www.entredevyops.es/">
                  
                    <img src="/images/edyo-logo.png" alt="Logo"/>
                  
              </a>
            </div>
            <div id="main-menu" class="nav-menu">
              
                <a class="menu subscription" data-action="subscription"
                    data-target="subscription" title="Suscríbete al Podcast">Suscríbete</a>
              
              <a class="nav-social" target="_blank" href="https://twitter.com/entredevyops" title="Entre Dev Y Ops en Twitter"><i class="fa fa-twitter"></i></a>
              <a class="nav-social" target="_blank" href="https://github.com/edyo" title="Entre Dev Y Ops en GitHub"><i class="fa fa-github"></i></a>
              <a id="search-button" onclick="$('#search-form').toggle();" title="Buscar"><i class="fa fa-search"></i></a>
              <form id="search-form" method="get" role="search" action="https://google.es/search">
                <input type="hidden" name="as_sitesearch" value="http://www.entredevyops.es/">
                <input type="text" name="q" maxlength="255" placeholder="Buscar..." class="form-control">
                <input type="submit" value="Buscar">
              </form>
              
                
              
              
                <a id="main-menu-button" class="menu" data-action="menu" data-target="menu"
                    title="Menú"><i class="fa fa-navicon"></i></a>
              
            </div>
          </nav>


<main class="content" role="main">
    <article class="post">
        <div class="inner">

            <div id="push">

                <header class="post-header">
                
                    <span class="post-meta">
                        <span class="post-date">11 Nov 2013</span> <span class="reading-time">| <span class="estimated-reading-time">10 min.</span> (<span class="word-count">1954</span> palabras)</span></span>
                    </span>
                <div class="clear"></div>
                
                <h1 class="post-title">Segundo día en la BcnDevCon&#39;13</h1>
              </header>

              <section class="post-content">
                
                  <div class="document">


<img alt="BcnDevCon13" class="border align-right" src="/images/bcndevcon13.jpeg" style="width: 125px; height: 125px;" />
<p>El segundo día de la <a class="reference external" href="http://bcndevcon.org">BcnDevCon</a>'13 estuvo plagado de charlas y actividades, el final del <a class="reference external" href="http://bcndevcon.org/hackathon/">Hackathon for education</a>, Los concursos de Mario Kart y Street Fighter. El salón de <a class="reference external" href="http://bcndevcon.org/retrobarcelona/">RetroBarcelona</a> fue muy visitado y la <a class="reference external" href="http://bcndevcon.org/activities/agile-station/">Agile Station</a>, coordinada por la gente de <a class="reference external" href="http://barcelona.agile-spain.org/">Agile BCN</a>, tuvo una actividad frenética, como el día anterior.</p>
<p></p>
<div class="section" id="problemas-de-la-escalabilidad">
<h2>Problemas de la escalabilidad</h2>
<p><a class="reference external" href="https://twitter.com/davidpoblador">David Poblador</a>, responsable de disponibilidad en <a class="reference external" href="http://www.spotify.com">Spotify</a>, explicó cómo su infraestructura, usuarios y servicios han crecido en los últimos cinco años. Su crecimiento, en datos resumidos, serían como sigue:</p>
<ul class="simple">
<li>1000M de listas de reproducción, actualmente. En 2010, tenían 400M y añaden 2M cada día.</li>
<li>De 20 servidores en 2008, pasaron a 1300 en 2011, y a más de 6000 en 2013.</li>
<li>Se encuentran en 32 mercados, pero en 201 sólo estaban en 12 mercados.</li>
<li>En 2010, el equipo de operaciones e infraestructura lo componían 10 personas, lo que provocó mucha deuda técnica. Ahora son diez veces más.</li>
<li>Actualmente, tienen 4 centros de datos lógicos. Aunque algunos de éstos, se componen en algunos más, no están muy alejados entre ellos.</li>
<li>Más de 20M canciones, y añaden 20000 nuevas diariamente.</li>
<li>Más de 24M de usuarios activos.</li>
<li>Más de 50 equipos creando nuevos componentes y productos.</li>
<li>Alrededor de 100 sistemas de <em>backend</em>.</li>
</ul>
<p>Estas condiciones de dimensión y crecimiento han provocado que recopilen mucho conocimiento aprendiendo al encontrarse con problemas que superar. Respecto al escalado de los centros de datos, destacó cierto puntos a tener en cuenta:</p>
<ol class="arabic simple">
<li>Cuando se es pequeño, es necesario admitir que siempre habrá alguien que sabrá y podrá montar centros de datos mejor que uno mismo.</li>
<li>Simplificar el proceso de adquisición. El contacto y trato con los proveedores es crítico.</li>
<li>Tener una unidad de capacidad para el aprovisionamiento. Consiste en una medida que contengan los servidores y el resto de infraestructura necesaria para su conexionado, que facilitará el aprovisionamiento y su conexionado. En su caso, la llaman <em>POD</em>, y consta de 44 racks casi llenos de servidores.</li>
<li>Los centros de datos se están convirtiendo en un servicio poco habitual, debido a la utilización de cloud.</li>
</ol>
<p>Hablando del escalado del <em>backend</em>, explicó cómo funciona su sistema. Los usuarios, con su cliente, se conectan a uno de una serie de servidores, llamados <em>Access Points</em>, mediante una única conexión TCP. El cliente pedirá las playlists, que el AP recuperará del sistema de <em>backend</em> correspondiente. Para poder escalar esta infraestructura, deben ser conscientes de sus límites, por ejemplo, si un AP puede atender 60K usuarios (es un valor hipotético), para atender 600K, serán necesarios más de 10 APs, para evitar problemas al caer uno de ellos.</p>
<p>Expuso el lema 'No intentes ser demasiado inteligente'. Como ingenieros, es frecuente que, al intentar resolver algun problema o necesidad, se intente cubrir con una respuesta completa, a menudo, mucho más allá de lo necesario. Por ejemplo, para identificar cuáles son los nodos que están dando servicios, decidieron utilizar el <em>DNS</em>. De este modo, disponían de un servicio ya construido que es simple, estándar y conocido. Lo utilizaron para funciones como:</p>
<ul class="simple">
<li>Registro de errores.</li>
<li>Búsqueda de anillos de <em>DHT</em>.</li>
<li>Descubrimiento de servicios (utilizan registros <tt class="docutils literal">SRV</tt>).</li>
<li>Distribución de usuarios por zona geográfica.</li>
</ul>
<p>No obstante, se encontraron con ciertos problemas:</p>
<ul class="simple">
<li>Los terminales iPhone, en todas sus versiones de iOS, tiene ciertos detalles como descartar todas las respuestas más allá del octavo registro. Muchos usuarios con iPhone acababan en un grupo pequeño de APs, que acababan saturándose.</li>
<li>El uso de los DNS de Google, como 8.8.8.8, muy extendido en Europa, causó muchos usuarios europeos acabaran en APs de Estados Unidos.</li>
</ul>
<p>Resolvieron estos protocolos dejando de utilizar el protocolo <em>DNS</em>. Utilizan un servicio que responde con estructuras <a class="reference external" href="http://es.wikipedia.org/wiki/JSON">JSON</a> que pueden gestionar mejor.</p>
<p>El almacenamiento es otro punto de la infraestructura que conviene escalar convenientemente. Se encontraron con el caso de un servicio de <em>backend</em> que indexa las canciones. Sus índices, al principio, cabían en <em>RAM</em>, pero, cuando dejaron de hacerlo, su rendimiento pasó a depender de la velocidad de sus discos duros, unos pocos cientos de <em>IOPS</em>. Por lo que pasar a depender de discos <em>SSD</em> se convirtió en una necesidad que mejoraba el rendimiento de forma sencilla, y su coste dejó de considerarse caro. También se pueden utilizar unidades <a class="reference external" href="http://www.fusionio.com">Fusion IO</a>, que proveen 25 veces la cantidad de <em>IOPS</em> de un <em>SSD</em> medio, pero todavía es bastante cara.</p>
<p>Un servicio muy pequeño, dedicado a mantener una copia de las páginas, necesitaba 32GB de RAM, de las que 2 eran para el sistema operativo, indexando en 10Gb, 10 millones de canciones. Por lo que un crecimiento de 20 millones de canciones debería ser soportable. El problema es que mantener los índices en memoria causaba, por el uso de las caches, que realmente ocupara 3 GB más, con lo que los 30 millones de canciones, no ocupaban 30GB sinó 39GB. La solución pasó por modificar el servicio para que utilizara la llamada <tt class="docutils literal">posix_fadvise</tt> para evitar utilizar caché. También se puede organizar un mejor despliegue del índice en memoria. Otra opción podría haber utilizado <tt class="docutils literal">mlock</tt> para restringir este caso.</p>
<p>La gestión de reintentos en las conexiones también es algo delicado. Cuando un cliente en <a class="reference external" href="http://www.spotify.com">Spotify</a> pierde su conexión, o se vuelve muy lenta, empieza a reintentar, lo que llevará a saturar los APs. Para evitar esto, lo reintentan menos veces y aplicando un ascenso exponencial en el tiempo de espera de cada uno de los reintentos. Con esto la capacidad de conexiones de los APs pueden ser recuperadas a tiempo para seguir atendiendo.</p>
<p>También es importante el concepto &quot;fallar tan rápido como sea posible&quot;, de forma que si los APs pierden conectividad con los <em>backends</em>, se lo comuniquen al cliente tan rápido como sea posible, para que busque alternativas o se conecte a otros APs. Hay situaciones en las que puede ser interesante que el cliente pueda aceptar una degradación del servicio sin fallar del todo.</p>
<p>Una de las cosas que hacen es utilizar usuarios reales para testear, por ejemplo, enviando un porcentaje de usuarios a un porcentaje de servidores. Suelen actualizar los clientes en bloques en distintos intervalos, de modo que pueden ir analizando cómo funciona todo.</p>
<p>Aunque son muy aficionados, han decidido automatizar sólo cuando sea necesario. Sí que tienen toda la infraestructura disponible como servicio, de modo que los equipos que trabajan en las distintas plataformas pueden servirse ellos mismos cuando lo necesitan.</p>
<p>En relación al crecimiento, han tenido que delegar la responsabilidad de la disponibilidad a los que están implicados en la plataforma. Son estos los que se encuentran con los problemas y, cuando no pueden resolverlos,ce piden reciben ayuda y consejo de la experiencia de los técnicos de operaciones. El equipo de operaciones se centra en extender la plataforma</p>
<p>Finalmente, es muy importante recordar que los incidentes no deben ocurrir dos veces. Cuando ocurre una vez, se establece la severidad, se reúnen a todos los implicados y se aplican, con urgencia, las soluciones oportunas.</p>
</div>
<div class="section" id="django-best-practices">
<h2>Django Best Practices</h2>
<p><a class="reference external" href="https://twitter.com/DZPM">David Arcos</a> dió una interesante charla sobre las mejores prácticas al utilizar <a class="reference external" href="http://djangoproject.com">Django</a>, un <em>framework</em> web muy conocido para <a class="reference external" href="http://python.org">Python</a>. En términos generales, concretó los siguientes puntos:</p>
<ul class="simple">
<li>Seguir la filosofía de <a class="reference external" href="http://python.org">Python</a> y <a class="reference external" href="http://djangoproject.com">Django</a> tanto como sea posible.</li>
<li>No reinventar la rueda, permanecer sobre la espalda de los gigantes.</li>
<li>Utilizar <a class="reference external" href="http://www.virtualenv.org">virtualenv</a>, con <a class="reference external" href="http://virtualenvwrapper.readthedocs.org/en/latest/">virtualenvwrapper</a>, para crear un entorno para cada proyecto, con todas sus diferentes dependencias, versiones distintas de las librerías, etc. Para instalar algo, utilizar <tt class="docutils literal">pip</tt>, que permite salvar las dependencias con sus versiones en un fichero, que se incluye con el resto del código, y utilizarlo para repetir la instalación en otro equipo.</li>
<li>Aclarar la nomenclatura proyecto/aplicaciones de Django. Utilizar nombres cortos, de una sola palabra, obvios para las aplicaciones. Es mejor que éstas sean pequeñas y muchas, antes que pocas y grandes. Si lo que hace la aplicación necesita una frase, probablemente se puede hacer con más de una aplicación. No reinventar la rueda, utilizar aplicaciones contribuidas o de terceros.</li>
<li>Varios ficheros de <em>settings</em>, según el entorno. Todos los ficheros heredan de uno que es base. Incluirlos en el control de versiones.</li>
<li>Modelo <em>MTV</em> (<em>Model</em> - <em>Template</em> - <em>View</em>). Es el modelo de <a class="reference external" href="http://djangoproject.com">Django</a> y conviene conocerlo y respetarlo. Los modelos contienen la lógica, las vistas deben ser simples y las plantillas mucho más simples. Un buen ejemplo, es el modelo de usuarios que incluyen en contribuidos. Utilizar <a class="reference external" href="http://jinja.pocoo.org/docs/">Jinja2</a> en las plantillas, pero en casos muy concretos. Es mejor tener plantillas mantenibles que HTML bonito.</li>
</ul>
<p>Para el despliegue, comentó los siguientes puntos:</p>
<ul class="simple">
<li><a class="reference external" href="http://nginx.org">Nginx</a>, <a class="reference external" href="http://gunicorn.org">gunicorn</a> y <a class="reference external" href="http://supervisord.org">supervisord</a>, para mantener vivo al segundo, es una buena combinación para ejecutarlo. Para los estáticos recomienda utilizar <a class="reference external" href="http://nginx.org">Nginx</a> o, en casos muy extremos, una <em>CDN</em>.</li>
<li><a class="reference external" href="http://fabfile.org">Fabric</a>, que permite programar tareas automatizadas que interactúan con los servidores por <em>SSH</em>.</li>
<li><a class="reference external" href="http://southaeracode.org">South</a>, exclusiva para <a class="reference external" href="http://djangoproject.com">Django</a>, se integra con el modelo y permite crear los ficheros de migración automáticamente, que luego se pueden modificar.</li>
<li><a class="reference external" href="http://www.celeryproject.org">Celery</a> consiste en un sistema de tareas asíncronas y encolado de trabajos basado en mensajes distribuidos. Necesita una cola de mensajes. Recomienda utilizar <a class="reference external" href="http://redis.io">Redis</a> antes que <a class="reference external" href="http://www.rabbitmq.com">RabbitMQ</a>.</li>
<li><a class="reference external" href="http://redis.io">Redis</a>, para almacenar sesiones activas, cache en general, compatible con <a class="reference external" href="http://memcached.org/">memcached</a>. Ideal para cálculos en real-time, estadísticas, monitoring, throttling, mensajes, índices y filtros.</li>
<li><a class="reference external" href="http://sentry.readthedocs.org/en/latest/quickstart/">Sentry</a>, donde poder llevar el registro de eventos, agregándolos. Permite monitorizar errores, obtener toda la información para el post-mortem. Usa el <tt class="docutils literal">logger</tt> de <a class="reference external" href="http://python.org">Python</a>, es muy fácil de usar. Se puede desplegar en instancia o utilizarlo como <a class="reference external" href="http://getsentry.com">servicio</a>.</li>
</ul>
<p>Para la depuración:</p>
<ul class="simple">
<li><a class="reference external" href="http://ipython.org">IPython</a>, intérprete integrado en <tt class="docutils literal">manage.py shell</tt>.</li>
<li><a class="reference external" href="https://pypi.python.org/pypi/ipdb">ipdb</a>, para tracear.</li>
<li><a class="reference external" href="https://pypi.python.org/pypi/django-debug-toolbar">Django Debug Toolbar</a>, muy potente, para optimizar rendimiento de la base de datos vista a vista.</li>
</ul>
</div>
<div class="section" id="unit-testing-y-el-mito-de-los-0-bugs">
<h2>Unit testing y el mito de los 0 bugs</h2>
<p><a class="reference external" href="https://twitter.com/fernandoescolar">Fernando Escolar</a> explicó que testear es comparar la salida de un proceso ante una entrada, con la salida que se esperaba. Si coinciden, el test es correcto y devolverá un OK. Pero si no coinciden, el test deberá devolver un error.</p>
<p>Se presentó la siguiente clasificación:</p>
<ul class="simple">
<li><em>Whitebox</em>: Se conoce todo el código.</li>
<li><em>Blackbox</em>: No se conoce nada del código.</li>
<li><em>Visual testing</em>: Cuando se presenta la información del test de forma clara y visualmente identificable.</li>
<li><em>Greybox</em>: Se conoce parte del código.</li>
</ul>
<p>Se pueden identificar los siguientes niveles de test:</p>
<ul class="simple">
<li>Unitario: Se prueba una sola parte pequeña de la pieza. Se prueba un método o una función.</li>
<li>Integración: Se prueban todas las piezas juntas.</li>
<li>Sistema: Se prueba que todo el conjunto funciona.</li>
<li>Aceptación: Se prueba que cumple todo lo que se esperaba.</li>
</ul>
<p>Las siguientes características deben encontrarse en todas las pruebas:</p>
<ul class="simple">
<li><em>Fast</em>: Debe ser rápido sin crear esperas.</li>
<li><em>Isolated</em>: No puede depender de otros componentes.</li>
<li><em>Repeatable</em>: Debe ser repetible, en las mismas condiciones deberá dar el mismo resultado, hasta que se cambie el código.</li>
<li><em>Self-Validating</em>: Debe ser suficientemente simple para que sea correcto.</li>
<li><em>Timely</em>: Debe ser usado en el momento adecuado.</li>
</ul>
<p><a class="reference external" href="https://twitter.com/fernandoescolar">Fernando</a> además, añadió las siguientes:</p>
<ul class="simple">
<li>Profesional</li>
<li>Unitario</li>
<li>Automatizable</li>
<li>No usar recursos</li>
</ul>
<p>Estructura de cada uno de los tests:</p>
<ul class="simple">
<li><em>Assume</em>: Cosas que asumimos, contratos, especificación. Es opcional, según el caso.</li>
<li><em>Arrange</em>: Preparar el contexto, crear los objectos necesarioes, etc.</li>
<li><em>Act</em>: Interactuar con el método o función a testear.</li>
<li><em>Assert</em>: Confirmar el resultado, o los resultados.</li>
</ul>
<p>Para hacer código testeable, recomendó:</p>
<ul class="simple">
<li>Desacoplar y sustituir componentes por interfaces para todo.</li>
<li>Patrones: <em>Inversion of Control</em> y <em>Abstract Factory</em>.</li>
<li><em>Test doubles</em>: <em>Dummies</em>, <em>Fakes</em>, <em>Stubs</em>, <em>Spies</em> y <em>Mock</em>. Consisten en distintas técnicas para suplantar servicios que son necesarios para el test, pero no lo que se está testeando.</li>
<li>Evitar el uso de estáticos (<em>hard coded values</em>) y <em>singletons</em>.</li>
<li>Simplificar los constructores: No utilizar <tt class="docutils literal">new</tt> dentro del constructor, no asignar algo que no sean atributos, no usar <em>Initializer</em>, condicionales ni bucles.</li>
<li>Testear positivo y negativo.</li>
</ul>
<p>Y sobre las métricas de codigo, comentó las dos más importantes:</p>
<ul class="simple">
<li>Cyclomatic Complexity: Es el número de caminos diferentes que el algoritmo puede tomar.</li>
<li>Code Coverage: La proporción de líneas de código que, en algún momento, se comprueban en tests unitarios.</li>
</ul>
</div>
</div>
              </section>

              <footer class="post-footer">
                  <div class="post-tags">
            
            
                <a href="http://www.entredevyops.es/tags/eventos.html">Eventos</a>
            
                <a href="http://www.entredevyops.es/tags/bcndevcon.html">BcnDevCon</a>
            
                <a href="http://www.entredevyops.es/tags/devops.html">DevOps</a>
            
                <a href="http://www.entredevyops.es/tags/escalabilidad.html">Escalabilidad</a>
            
                <a href="http://www.entredevyops.es/tags/python.html">Python</a>
            
                <a href="http://www.entredevyops.es/tags/pruebas.html">Pruebas</a>
            
                <a href="http://www.entredevyops.es/tags/tdd.html">TDD</a>
            
            
                  </div>
                
                    <div class="post-share">
                        <a class="fa fa-twitter" href="https://twitter.com/share?text=Segundo%20d%c3%ada%20en%20la%20BcnDevCon%2713&url=http%3a%2f%2fwww.entredevyops.es%2fposts%2fbcndevcon-2013-segundo-dia.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                            <span>Twitter</span>
                        </a>
                        <a class="fa fa-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fwww.entredevyops.es%2fposts%2fbcndevcon-2013-segundo-dia.html&title=Segundo%20d%c3%ada%20en%20la%20BcnDevCon%2713&summary=%3cdiv%20class%3d%22document%22%3e%0a%0a%0a%3cimg%20alt%3d%22BcnDevCon13%22%20class%3d%22border%20align-right%22%20src%3d%22%2fimages%2fbcndevcon13.jpeg%22%20style%3d%22width%3a%20125px%3b%20height%3a%20125px%3b%22%20%2f%3e%0a%3cp%3eEl%20segundo%20d%c3%ada%20de%20la%20%3ca%20class%3d%22reference%20external%22%20href%3d%22http%3a%2f%2fbcndevcon.org%22%3eBcnDevCon%3c%2fa%3e%2713%20estuvo%20plagado%20de%20charlas%20y%20actividades%2c%20el%20final%20del%20%3ca%20class%3d%22reference%20external%22%20href%3d%22http%3a%2f%2fbcndevcon.org%2fhackathon%2f%22%3eHackathon%20for%20education%3c%2fa%3e%2c%20Los%20concursos%20de%20Mario%20Kart%20y%20Street%20Fighter.%20El%20sal%c3%b3n%20de%20%3ca%20class%3d%22reference%20external%22%20href%3d%22http%3a%2f%2fbcndevcon.org%2fretrobarcelona%2f%22%3eRetroBarcelona%3c%2fa%3e%20fue%20muy%20visitado%20y%20la%20%3ca%20class%3d%22reference%20external%22%20href%3d%22http%3a%2f%2fbcndevcon.org%2factivities%2fagile-station%2f%22%3eAgile%20Station%3c%2fa%3e%2c%20coordinada%20por%20la%20gente%20de%20%3ca%20class%3d%22reference%20external%22%20href%3d%22http%3a%2f%2fbarcelona.agile-spain.org%2f%22%3eAgile%20BCN%3c%2fa%3e%2c%20tuvo%20una%20actividad%20fren%c3%a9tica%2c%20como%20el%20d%c3%ada%20anterior.%3c%2fp%3e%0a%3cp%3e%3c%2fp%3e%3c%2fdiv%3e" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=550');return false;">
                            <span>LinkedIn</span>
                        </a>
                    </div>
            
              </footer>

            
                <aside class="post-comments">
    
    
    <div id="disqus_thread"></div>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
    
</aside>

            
            </div>

            <nav class="post-nav">
                
                    <a class="post-nav-item post-nav-next" href="http://www.entredevyops.es/posts/bcndevcon-2013-tercer-dia.html">
                        <section class="post-nav-teaser">
                            <span class="post-nav-icon"><i class="fa fa-chevron-left"></i></span>
                            <span class="post-nav-info">
                                <h4 class="post-nav-title">Tercer día en la BcnDevCon&#39;13</h4>
                            </span>
                        </section>
                    </a>
                
                
                    <a class="post-nav-item post-nav-prev" href="http://www.entredevyops.es/posts/amazon-ws-elb-balancea-entre-zonas.html">
                        <section class="post-nav-teaser">
                            <span class="post-nav-icon"><i class="fa fa-chevron-right"></i></span>
                            <span class="post-nav-info">
                                <h4 class="post-nav-title">ELB de Amazon WS balancea entre zonas de disponibilidad</h4>
                            </span>
                        </section>
                    </a>
                
                <div class="clear"></div>
            </nav>

        </div>
    </article>
</main>

                <div id="body-class" style="display: none;"></div>
                <footer id="footer">
                    <section class="credits">
                        
                        <span class="credits-license"><i class="fa
                                fa-copyright"></i> 2013-2018 Entre Dev y Ops, licencia <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.es_ES"><i class="fa fa-creative-commons"></i> BY-NC-SA 3.0</a>
                        
                        
                        — <a href="politica-cookies.html">Política de cookies</a>
                        
                    </span>
                    <span class="credits-software">Publicado con
                        <a href="http://gohugo.io" target="_blank" rel="nofollow">Hugo</a>,
                        tema basado en <a href="https://github.com/zenithar/hugo-theme-bleak" target="_blank" rel="nofollow">Bleak</a>
                        por <a href="http://zutrinken.com" target="_blank" rel="nofollow">zutrinken</a></span>
                    </section>
                </footer>
                
<div id="subscription" data-target="subscription">
    <div class="menu-header">
        <span class="menu-label">Suscríbete</span>
        <a class="menu-close" data-action="subscription" data-target="subscription"></a>
    </div>

    <div class="menu-list">
        
        
        <li class="menu-list-item">
            <i class='fa fa-rss'></i>
            <a target="_blank" href="http://feedpress.me/edyo">Podcast RSS</a>
        </li>
        
        
        <li class="menu-list-item">
            <i class='fa fa-podcast'></i>
            <a target="_blank" href="https://www.ivoox.com/podcast-entre-dev-y-ops-podcast_sq_f1112910_1.html">Podcast en iVoox</a>
        </li>
        
        
        <li class="menu-list-item">
            <i class='fa fa-apple'></i>
            <a target="_blank" href="https://itunes.apple.com/es/podcast/entredevyops-podcast/id866788492">Podcast en iTunes</a>
        </li>
        
        
        <li class="menu-list-item">
            <i class='fa fa-rss'></i>
            <a target="_blank" href="/rss.xml">Web RSS</a>
        </li>
        
    </div>

</div>


                
<div id="menu" data-target="menu">
    <div class="menu-header">
        <span class="menu-label">Menú</span>
        <a class="menu-close" data-action="menu" data-target="menu"></a>
    </div>

    <div class="menu-list">
        
        
        <li class="menu-list-item">
            
            <a class="home current js-ajax-link" href="/podcasts.html">Episodios podcast</a>
        </li>
        
        
        <li class="menu-list-item">
            
            <a class="home current js-ajax-link" href="/posts.html">Artículos</a>
        </li>
        
        
        <li class="menu-list-item">
            
            <a class="home current js-ajax-link" href="/equipo.html">Equipo</a>
        </li>
        
        <li class="menu-list-item menu-list-social">
            <a href="https://twitter.com/entredevyops" title="Entre Dev Y Ops en Twitter"><i class="fa fa-twitter"></i></a>
            <a href="https://github.com/edyo" title="Entre Dev Y Ops en GitHub"><i class="fa fa-github"></i></a>
        </li>
    </div>

</div>


                
                <div class="overlay"></div>
            </div>
        </section>

    <script async src="/js/main.js"></script>

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-25613214-1', 'auto');
        ga('send', 'pageview');
    </script>
    



  <noscript><link rel="stylesheet" href="/css/main.css"></noscript>
</body>
</html>

